#include <msp430.h>
#include "aes-naive.h"
#include "tools.h"

int main ()
{

    WDTCTL = WDTPW | WDTHOLD;   // Stop watchdog timer
    PM5CTL0 &= ~LOCKLPM5;       // Lock LPM5.

    AES_CTX ctx;
    u8 akey[16]={0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED};
    u8 adata[16]={0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED,0xED};

    u8 digest[16];
    u8 decrypt[16];

    START_DECRYPT();
    AES_init(&ctx, akey);
    AES_decrypt(&ctx, digest, decrypt);
    END_EXPE();

    return 0;
}
